<% include ./partials/header %>

<nav class="navbar navbar-expand-lg">
  <div class="container">
    <span class="navbar-brand mx-auto text-light nav-text">Logged in as <a href="#" class="text-white"><%= user.body.display_name %></a></span>
  </div>
</nav>

<div class="container mt-5">
	<div class="jumbotron text-center rounded-lg">
		<div id="showScoreHtml" class="d-none">
			<h1 class="option" id="H1Score">Your Score is <span id="scoreWhileUserIsPlaying" class="text-success"><%= %></span></h1>
			<button onclick="location.reload();" id="playAgain" class="btn btn-dark btn-lg rounded-lg d-none mt-2"><i class="fa fa-redo-alt mr-2"></i>   Try Again</button>
		</div>
		<div id="welcome" class="d-none">
			<h1 class="text-center">Welcome to the</h1>
			<h1 class="display-4">
				<i class="fas fa-music text-secondary mr-3"></i>
				<span id="title">Spotify-Popularity-Game</span>
				<i class="fas fa-music text-secondary ml-3"></i>
			</h1>
			<a class="btn btn-dark mt-2 btn-lg rounded-lg" href="/more-info" role="button">More Information</a>
		</div>
	</div>
</div>	

<div class="container" id="theBody">
	<div class="row">
		<div class="col-lg-6 text-center">
			<center>
				<% for (var i = Math.floor(Math.random() * 50), j = 0; j < 1; j++) { %>
				<div class="card bg-none border-0" style="width: 30rem;">	
					<img src="<%= savedTracks.body.items[i].track.album.images[0].url %>" class="card-img-top">
					<div class="card-body">
						<h1 class="card-title option choice_one"><%= savedTracks.body.items[i].track.name %></h1>
						<button class="btn btn-outline-success btn-block rounded-pill choice_one_btn"><i class="fas fa-caret-up fa-3x"></i></button>
					</div>
				</div>
				<% } %>
			</center>
		</div>
		
		<div class="col-lg-6">
			<center>
				<% for (var k = Math.floor(Math.random() * 50), m = 0; m < 1; m++) { %>
				<div class="card bg-none border-0" style="width: 30rem;">
					<img src="<%= savedTracks.body.items[k].track.album.images[0].url %>" class="card-img-top">
					<div class="card-body">
						<h1 class="card-title option choice_two"><%= savedTracks.body.items[k].track.name %></h1>
						<button class="btn btn-outline-success btn-block rounded-pill choice_two_btn"><i class="fas fa-caret-up fa-3x"></i></button>
					</div>
				</div>
				<% } %>
			</center>
		</div>
	</div>
</div>


<script>
	var score = localStorage.getItem("theScore");

	if (score == null || score == 0) {
		score = 0;
		localStorage.setItem("theScore", score);
		$("div#welcome").removeClass("d-none");
	} else {
		$("div#showScoreHtml").removeClass("d-none");
		$("span#scoreWhileUserIsPlaying").html(score);
	}
	
	$("button.choice_two_btn").on("click", function() {
		var first_song = <%= savedTracks.body.items[i].track.popularity %>;
		var second_song = <%= savedTracks.body.items[k].track.popularity %>;
		if(second_song > first_song) {
			ifUserGuessesRight();
		} else if(second_song == first_song) {
			ifSamePopularity();
		} else {
			ifUserGuessesWrong();
		}
	});

	$("button.choice_one_btn").on("click", function() {
		var first_song = <%= savedTracks.body.items[i].track.popularity %>;
		var second_song = <%= savedTracks.body.items[k].track.popularity %>;
		if(first_song > second_song) {
			ifUserGuessesRight();
		} else if(second_song == first_song) {
			ifSamePopularity();
		} else {
			ifUserGuessesWrong();
		}
	});
	
	function ifUserGuessesRight() {
		score++;
		localStorage.setItem("theScore", score);
		alert("correct");
		location.reload();
	}
	
	function ifSamePopularity() {
		alert("same popularity");
		location.reload();
	}
	
	function ifUserGuessesWrong() {
		$("button#playAgain").removeClass("d-none");
		$("h1#H1Score").html("Your Final Score is <span id='scoreWhileUserIsPlaying' class='text-success'>" +  score + "</span");
		score = 0;
		localStorage.setItem("theScore", score);
		alert("wrong");
		$("#theBody").addClass("d-none");
	}
</script>
<!-- 
<div class="container d-none" id="showScoreHtml">
	<div class="jumbotron text-center">
		<h1 class="option">Your Score is <span class="scoreHTML"></span></h1>
		<button onclick="location.reload();" class="btn btn-dark btn-lg rounded-lg mt-2"><i class="fa fa-redo-alt mr-2"></i>   Try Again</button>
	</div>
</div> -->

<% include ./partials/footer %>

<!-- savedTracks.body.items[i].track.name -->
<!-- savedTracks.body.items.length  -->
<!-- songs.songs_arr[Math.floor(Math.random() * 51)] -->